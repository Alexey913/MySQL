# Базы данных

# [Курс Введение в базы данных](введение-в-базы-данных)

# [Курс Базы данных и SQL](#базы-данных-и-sql)

# Введение в базы данных

## [Семинар 1 - Знакомство с базами данных]()

## [Домашнее задние 1]()
Составьте таблицы для хранения сведений об общественном транспорте. Можно на примере автобусов. При составлении таблиц не берите слишком много сущностей. Ориентируйтесь на структуру типа: «У нас есть автобусы на разных маршрутах, у автобуса есть водитель, также в автобусе работает кондуктор». Более сложные/глубокие структуры пока лучше не брать.

## [Семинар 2 - Работа с данными из разных таблиц]()

## [Домашнее задние 2]()
Чему будет равна выборка:
* SELECT ФИО, Д/р, Адрес FROM Общий список
* SELECT ФИО, Статус FROM Общий список WHERE Адрес = «Можга»
* SELECT ФИО FROM Общий список WHERE Адрес = «Москва» AND Группа = «Работа»
* SELECT Д/р FROM Общий список WHERE Адрес = «Москва» OR Группа = «Работа»

Что будет результатом следующих JOIN’ов:
* INNER JOIN Люди, Адреса ON id = Чей адрес
* LEFT JOIN Люди, Адреса ON id = Чей адрес
* RIGHT JOIN Люди, Адреса ON id = Чей адрес
* FULL JOIN Люди, Адреса ON id = Чей адрес

Дополнительное задание. Что будет результатом выборки:
* SELECT ФИО, Адрес, Комментарий FROM Люди RIGHT JOIN Адреса ON id = Чей Адрес

## [Семинар 3 - Создание структуры базы данных]()

## [Домашнее задние 3]()
Опишите базу данных для школьного кабинета, в рамках которой можно фиксировать, кто и в какое время сидел за той или иной партой.
* Место ученика — это ряд, парта, вариант.
* В течение одного дня у разных классов бывает несколько уроков.
* Создайте минимум 3 таблицы: «Кабинет», «Ученик» и сводная таблица, где отображаются парты и ученики.
* Используйте поля «началоурока» и «конецурока» с типом данных TimeStamp.













# Базы данных и SQL

## [Семинар 1 - Установка СУБД, подключение к БД, просмотр и создание таблиц](Les1)
Работа с User Interface
## [Домашнее задние 1](Les1/Скриншоты к ДЗ1.pdf)
1. Создайте таблицу с мобильными телефонами, используя графический интерфейс. Заполните БД данными
2. Выведите название, производителя и цену для товаров, количество которых превышает 2
3. Выведите весь ассортимент товаров марки “Samsung”
4. Выведите информацию о телефонах, где суммарный чек больше 100000 и меньше 145000
5. С помощью регулярных выражений найти (можно использовать операторы “LIKE”, “RLIKE для 5.3” ): 5.1. Товары, в которых есть упоминание "Iphone" 5.2. "Galaxy" 5.3. Товары, в которых есть ЦИФРЫ 5.4. Товары, в которых есть ЦИФРА "8"

## [Семинар 2 - SQL – создание объектов, простые запросы выборки](Les2)
### [Задание 1](Les2/marks_if.sql)
Имеется [таблица успеваемости студентов](Les2/img41651564984651312.png)
В зависимости от общего количество баллов, укажите статус ученика в табеле успеваемости: если суммарное количество баллов больше 450, то студент закончил на “Отлично”; иначе - “Хорошо”.
### [Задание 2](Les2/marks_case.sql)
В [таблице успеваемости студентов](Les2/img41651564984651312.png) в зависимости от поля “grade”, установите еще один столбец с именем class в зависимости от значений: A++ – DISTINCTION,A+ – FIRST CLASS, A – SECOND CLASS, B+ – SECOND CLASS, C+ – THIRD CLASS, ALL OTHERS – FAIL

## [Домашнее задние 2](Les2/HW2)
### Задание 1
Используя операторы языка SQL, [создайте](Les2/HW2/01_create_sales.sql) табличку “sales”. [Заполните](Les2/HW2/02_fill_sales.sql) ее данными
[Таблица к заданию](Les2/Image20230307214641.png)
### [Задание 2](Les2/HW2/03_check_sum.sql)
Сгруппируйте значений количества в 3 сегмента — меньше 100, 100-300 и больше 300.
[Таблица к заданию](Les2/Image20230307214641.png)
### Задание 3
[Создайте](Les2/HW2/04_create_orders.sql) таблицу “orders”, [заполните](Les2/HW2/05_fill_orders.sql) ее значениями. [Покажите “полный” статус заказа](Les2/HW2/06_check_orders.sql), используя оператор CASE
[Таблица к заданию](Les2/img41651564984651321.png)
### [Задание 4](Les2/HW2/00_Выполнение_ДЗ2.sql)
Чем NULL отличается от 0?

## [Семинар 3 - SQL – выборка данных, сортировка, агрегатные функции](Les3)
### [Задание 1](Les3/workers.sql)
[Таблица для работы](Les3/HW3/img41651564984651312.png)
1. Выведите все записи, отсортированные по полю "age" по возрастанию
2. Выведите все записи, отсортированные по полю "name"
3. Выведите записи полей "name", "surname","age", отсортированные по полю "name" в алфавитном порядке по убыванию
4. Выполните сортировку по полям "name" и "age" по убыванию
5. Выведите уникальные (неповторяющиеся) значения поля"name"
6. Выведите первые две первые записи из таблицы
7. Пропустите первые 4 строки ("id" = 1, "id" = 2,"id" = 3,"id" = 4) и извлеките следующие 3 строки ("id" = 5, "id" = 6, "id" = 7)
8*. Пропустите две последнии строки (где id=12, id=11) и извлекаются следующие за ними 3 строки (где id=10, id=9, id=8)

### [Задание 2](Les3/empl.sql)
[Таблица для работы](Les3/img41651564984651312.png)
1. Рассчитайте общее количество всех страниц dialy_typing_pages
2. Выведите общее количество напечатанных страниц каждым человеком (с помощью предложения GROUP BY)
3. Посчитайте количество записей в таблице
4. Выведите количество имен, которые являются уникальными
5. Найдите среднее арифметическое по количеству ежедневных страниц для набора (daily_typing_pages)

### [Задание 3](Les3/staff.sql)
[Таблица для работы](Les3/img41651564984651321.png)
1. Сгруппируйте поля по возрасту (будет 3 группы - 23 года, 24 года и 25 лет). Для каждой группы найдите суммарную зарплату
2. Сгруппируйте поля по возрасту (будет 3 группы - 23 года, 24 года и 25 лет). Найдите максимальную заработную плату внутри группы
3. Сгруппируйте поля по возрасту (будет 3 группы - 23 года, 24 года и 25 лет). Найдите минимальную заработную плату внутри группы
4. Выведите только те строки, в которых суммарная зарплата больше или равна 1000
5. Выведите только те группы, в которых количество строк меньше или равно двум
6. Выведите только те группы, в которых количество строк меньше или равно двум. Для решения используйте оператор “BETWEEN”
7.* Выведите только те группы, в которых количество строк меньше или равно двум. Для решения используйте оператор “IN”

## [Домашнее задние 3](Les3/HW3)
[Таблица для работы](Les3/HW3/img41651564984651312.png)
1. Отсортируйте поле “зарплата” (salary) в порядке убывания и возрастания
2. Выведите 5 максимальных зарплат (salary)
3. Подсчитать суммарную зарплату(salary) по каждой специальности (speciality)
4. Найти количество сотрудников по специальности “Рабочий” (speciality) в возрасте от 24 до 42 лет.
5. Найти количество специальностей
6. Вывести специальности, у которых средний возраст сотрудника меньше 44 лет
[Создание и заполнение таблиц](Les3/HW3/create_staff.sql)
[Выполнение задания](Les3/HW3/exercises.sql)

## [Семинар 4 - SQL – работа с несколькими таблицами](Les4)
### [Задание 1](Les4/seminar_script.sql)
Таблицы для работы созданы в файле задания
1. Получить фамилию учителей и курсы, которые они ведут
2. Выбрать фамилию всех учителей и курсы, которые они ведут. Если учитель не ведет курс, его фамилию все равно необходимо вывести
3. Вывести учителей, которые не ведут никакие курсы
4. Получите список курсов и учителей , которые их ведут (используя RIGHT JOIN)
5. Получить информацию по учителям , которые ведут курс "Знакомство с веб-технологиями"
5.1. С помощью фильтра “WHERE”
5.2. С помощью подзапроса (выборка с помощью с SELECT-a)
6. Получить все строчки левой и правой таблицы
### [Задание 2](Les4/Unions.sql)
Таблицы для работы созданы в файле задания
Получить список пользователей и клиентов. Дубликаты удалять не нужно

## [Домашнее задние 4](Les4/HW4.sql)
### Задание 1
Таблицы для работы созданы в файле задания
Используя JOIN-ы, выполните следующие операции:
1. Вывести всех котиков по магазинам по id (условие соединения shops.id = cats.shops_id)
2. Вывести магазин, в котором продается кот “Мурзик” (попробуйте выполнить 2 способами)
3. Вывести магазины, в котором НЕ продаются коты “Мурзик” и “Zuza”

### Задание 2
Таблицы для работы созданы в файле задания
Вывести всю информацию об анализах, которые продавались 5 февраля 2020 и всю следующую неделю.
Есть таблица анализов Analysis:
* n_id — ID анализа;
* an_name — название анализа;
* an_cost — себестоимость анализа;
* an_price — розничная цена анализа;
* an_group — группа анализов.

Есть таблица групп анализов Groups:
* gr_id — ID группы;
* gr_name — название группы;
* gr_temp — температурный режим хранения.

Есть таблица заказов Orders:
* ord_id — ID заказа;
* ord_datetime — дата и время заказа;
* ord_an — ID анализа.

## [Семинар 5 - SQL – оконные функции]()

## [Домашнее задние 5]()
### Задание 1
[Таблицу см. в презентации]()
1. Создайте представление, в которое попадут автомобили стоимостью до 25 000 долларов
2. Изменить в существующем представлении порог для стоимости: пусть цена будет до 30 000 долларов (используя оператор ALTER VIEW)
3. Создайте представление, в котором будут только автомобили марки “Шкода” и “Ауди”
### Задание 2
[Таблицу см. в презентации]()
Добавьте новый столбец под названием «время до следующей станции». Чтобы получить это значение, мы вычитаем время станций для пар смежных станций. Мы можем вычислить это значение без использования оконной функции SQL, но это может быть очень сложно. Проще это сделать с помощью оконной функции LEAD . Эта функция сравнивает значения из одной строки со следующей строкой, чтобы получить результат. В этом случае функция сравнивает значения в столбце «время» для станции со станцией сразу после нее.

## [Семинар 6 - SQL – Транзакции. Временные таблицы, управляющие конструкции, циклы]()

## [Домашнее задние 6]()
[Для решения задач используйте базу данных lesson_6]()
1. Создайте таблицу users_old, аналогичную таблице users. Создайте процедуру, с помощью которой можно переместить любого (одного) пользователя из таблицы users в таблицу users_old. (использование транзакции с выбором commit или rollback – обязательно).
2. Создайте хранимую функцию hello(), которая будет возвращать приветствие, в зависимости от текущего времени суток. С 6:00 до 12:00 функция должна возвращать фразу "Доброе утро", с 12:00 до 18:00 функция должна возвращать фразу "Добрый день", с 18:00 до 00:00 — "Добрый вечер", с 00:00 до 6:00 — "Доброй ночи".
3. (по желанию)* Создайте таблицу logs типа Archive. Пусть при каждом создании записи в таблицах users, communities и messages в таблицу logs помещается время и дата создания записи, название таблицы, идентификатор первичного ключа.
