CREATE TABLE bank
(
	TB VARCHAR(3),
	ID_CLIENT INT,
	ID_DOG INT,
	OSZ INT,
	PROCENT_RATE INT,
	RATING INT,
	SEGMENT VARCHAR(10)
);

INSERT INTO bank 
VALUES  ('A', 1, 111, 100, 6, 10, 'SREDN'),
	('A', 1, 222, 150, 6, 10, 'SREDN'),
	('A', 2, 333, 50, 9, 15, 'MMB'),
	('B', 1, 444, 200, 7, 10, 'SREDN'),
	('B', 3, 555, 1000, 5, 16, 'CIB'),
	('B', 4, 666, 500, 10, 20, 'CIB'),
	('B', 4, 777, 10, 12, 17, 'MMB'),
	('C', 5, 888, 20, 11, 21, 'MMB'),
	('C', 5, 999, 200, 9, 13, 'SREDN');

SELECT OSZ PROCENT_RATE, SEGMENT, MAX(OSZ)
OVER (PARTITION BY TB) "MAX_OSZ",
AVG(PROCENT_RATE)
OVER (PARTITION BY SEGMENT) "MIDDLE_PERCENT_RATE",
COUNT(ID_DOG)
OVER () "TOTAL_DOG"
FROM bank;